import streamlit as st
import pandas as pd
import streamlit as st
import util

# --- 1. カテゴリ定義 (階層構造) ---
CATEGORY_STRUCTURE = {
    "暮らしの支援": {
        "家事支援サービス": ["家事支援", "遺品整理"],
        "配達サービス": [
            "高齢者向け配食サービス",
            "フードデリバリー",
            "食料品配達",
            "移動販売",
        ],
        "外出支援・移動サービス": [
            "福祉タクシー",
            "コミュニティバス",
            "見守り安否確認",
        ],
        "住まい": [
            "住宅型有料老人ホーム",
            "サービス付き高齢者向け住宅",
            "高齢者住みかえ支援",
            "住宅改修",
        ],
        "その他": ["その他"],
    },
    "地域活動・社会参加": {
        "居場所づくり": ["サロン・通いの場", "趣味・交流の場"],
        "地域活動": [
            "市民団体",
            "ボランティア",
            "自治体",
            "ボランティア制度受入れ施設",
        ],
        "その他": ["その他"],
    },
    "医療・訪問サービス": {
        "訪問サービス": [
            "訪問診療",
            "訪問歯科診療",
            "訪問調剤",
            "訪問マッサージ",
            "訪問理美容",
            "訪問入浴",
        ],
        "その他": ["その他"],
    },
    "健康づくり・介護予防": {
        "運動": [
            "フレイル予防教室",
            "介護予防教室",
            "スポーツジム・フィットネスクラブ",
        ],
        "その他": ["その他"],
    },
}

# CSV出力時の列順序パターン
ORDER_PATTERNS = {
    "パターンA": ["概要", "料金", "サービス提供地域", "営業時間", "定休日"],
    "パターンB": ["概要", "サービス提供地域", "料金", "営業時間", "定休日"],
}

# セッション状態の初期値
INITIAL_SESSION_KEYS = {
    "data_list": [],
    "off_pref": "",
    "off_city": "",
    "off_town": "",
    "corp_pref": "",
    "corp_city": "",
    "corp_town": "",
    "ui_city_code": "",
    "ui_town_code": "",
    "addr_input": {
        "pref": "",
        "city": "",
        "town": "",
        "city_code": "",
        "town_code": "",
    },
    "corp_input": {"pref": "", "city": "", "town": ""},
}

# CSV出力時の固定ヘッダー順序
MASTER_ORDER_FRONT = [
    "大カテゴリ",
    "中カテゴリ",
    "小カテゴリ",
    "ステータス",
    "名称",
    "郵便番号",
    "都道府県",
    "市区町村",
    "町名",
    "番地",
    "建物名",
    "市区町村コード",
    "町域コード",
    "連番",
    "電話番号",
    "FAX番号",
    "ホームページ",
    "問い合わせメールアドレス",
    "備考",
    "緯度",
    "経度",
    "出店場所",
    "営業時間",
    "定休日",
    "介護保険登録事業者の有無",
    "アクセス",
    "空き情報",
    "(入居時の要件・状況)入居時の要件",
    "(入居時の要件・状況)入居時の要件(補足)",
    "(利用料金)入居時必要額",
    "(利用料金)月額",
    "営業エリア",
    "乗車定員",
    "保有台数",
    "乗客定員",
    "機能",
    "料金体系(距離制運賃)",
    "料金体系(時間制運賃)",
    "料金体系(時間距離併用)",
    "料金体系(その他)",
    "(距離制運賃)送迎運賃",
    "(距離制運賃)初乗運賃",
    "(距離制運賃)加算運賃",
    "(時間制運賃)送迎運賃",
    "(時間制運賃)初乗運賃",
    "(時間制運賃)加算運賃",
    "(共通)割引き",
    "(共通)その他",
    "(介助料金)基本介助料",
    "(介助料金)その他",
    "当日手配",
    "車いすの貸出",
    "ストレッチャーの貸出",
    "定期な従業員の研修",
    "独自のパンフレット",
]

MASTER_ORDER_END = ["問合せ先部署名", "問合せ先連絡先", "受理日"]
